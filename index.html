<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quick BMI Calculator</title>
    <!-- Load Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Inter', sans-serif; }
        /* Style for the radio button circles */
        input[type="radio"]:checked + span {
            background-color: #2563eb; /* blue-600 */
            border-color: #2563eb;
        }
    </style>
</head>
<body class="bg-gray-100 min-h-screen flex items-center justify-center p-4">

    <div id="app" class="bg-white p-6 md:p-10 rounded-xl shadow-2xl w-full max-w-lg">
        <h1 class="text-3xl font-extrabold text-gray-900 mb-4 text-center">
            BMI Calculator
        </h1>
        <p class="text-gray-500 mb-6 text-center">
            Calculate your Body Mass Index (BMI).
        </p>

        <!-- Unit Selection -->
        <div class="mb-6 flex space-x-4 justify-center">
            <label class="inline-flex items-center cursor-pointer">
                <input type="radio" name="unitSystem" value="metric" checked class="hidden" onchange="toggleUnits('metric')">
                <span class="w-5 h-5 inline-block mr-2 rounded-full border border-gray-400 flex-shrink-0 transition-colors duration-200"></span>
                <span class="text-gray-700 font-semibold">Metric (kg, m)</span>
            </label>
            <label class="inline-flex items-center cursor-pointer">
                <input type="radio" name="unitSystem" value="imperial" class="hidden" onchange="toggleUnits('imperial')">
                <span class="w-5 h-5 inline-block mr-2 rounded-full border border-gray-400 flex-shrink-0 transition-colors duration-200"></span>
                <span class="text-gray-700 font-semibold">Imperial (lbs, ft/in)</span>
            </label>
        </div>

        <!-- Input Form -->
        <div class="grid grid-cols-1 gap-6">
            <input type="text" id="name" placeholder="Name (e.g., John Doe)" class="p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 transition duration-150">
            <input type="number" id="age" placeholder="Age (years)" class="p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 transition duration-150">

            <!-- Metric Inputs (Default) -->
            <div id="metric-inputs">
                <input type="number" id="weight-kg" placeholder="Weight (kg)" class="p-3 border border-gray-300 rounded-lg w-full focus:outline-none focus:ring-2 focus:ring-blue-500 mb-6 transition duration-150">
                <input type="number" id="height-m" placeholder="Height (meters) e.g., 1.75" class="p-3 border border-gray-300 rounded-lg w-full focus:outline-none focus:ring-2 focus:ring-blue-500 transition duration-150">
            </div>

            <!-- Imperial Inputs (Hidden by default) -->
            <div id="imperial-inputs" class="hidden">
                <input type="number" id="weight-lbs" placeholder="Weight (pounds - lbs)" class="p-3 border border-gray-300 rounded-lg w-full focus:outline-none focus:ring-2 focus:ring-blue-500 mb-6 transition duration-150">
                <div class="grid grid-cols-2 gap-4">
                    <input type="number" id="height-ft" placeholder="Height (Feet)" class="p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 transition duration-150">
                    <input type="number" id="height-in" placeholder="Height (Inches)" class="p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 transition duration-150">
                </div>
            </div>

            <button onclick="calculateBMI()" class="mt-4 py-3 bg-blue-600 text-white font-bold rounded-lg hover:bg-blue-700 transition duration-200 shadow-md">
                Calculate BMI
            </button>
        </div>

        <!-- Result Display -->
        <div id="result-box" class="mt-8 p-4 border border-gray-200 rounded-lg hidden shadow-inner transition duration-300">
            <p id="error-message" class="text-red-600 font-semibold text-center mb-2 hidden"></p>
            <p id="bmi-display" class="text-3xl font-extrabold text-center mb-2 transition duration-300"></p>
            <p id="category-display" class="text-lg font-semibold text-center"></p>
            <p id="advice-display" class="text-sm text-gray-600 mt-3 text-center"></p>
        </div>
    </div>

    <!-- PWA Service Worker Registration -->
    <script>
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('./service-worker.js')
                    .then(registration => {
                        console.log('Service Worker registered:', registration);
                    })
                    .catch(error => {
                        console.error('Service Worker registration failed:', error);
                    });
            });
        }

        // --- JavaScript Logic ---
        function toggleUnits(unitSystem) {
            const metric = document.getElementById('metric-inputs');
            const imperial = document.getElementById('imperial-inputs');
            
            if (unitSystem === 'metric') {
                metric.classList.remove('hidden');
                imperial.classList.add('hidden');
            } else {
                metric.classList.add('hidden');
                imperial.classList.remove('hidden');
            }
            // Clear result box when units are switched
            document.getElementById('result-box').classList.add('hidden');
            document.getElementById('error-message').classList.add('hidden');
        }

        function getUnitSystem() {
            return document.querySelector('input[name="unitSystem"]:checked').value;
        }

        function calculateBMI() {
            const name = document.getElementById('name').value.trim();
            const age = parseFloat(document.getElementById('age').value);
            const unitSystem = getUnitSystem();
            let weightKg, heightM;

            const errorMsg = document.getElementById('error-message');
            const resultBox = document.getElementById('result-box');
            resultBox.classList.remove('hidden');
            errorMsg.classList.add('hidden');

            // --- 1. Get and Validate Input ---
            if (!name || isNaN(age) || age <= 0) {
                errorMsg.textContent = "Please enter a valid name and age.";
                errorMsg.classList.remove('hidden');
                return;
            }

            if (unitSystem === 'metric') {
                const weight = parseFloat(document.getElementById('weight-kg').value);
                const height = parseFloat(document.getElementById('height-m').value);
                
                if (isNaN(weight) || weight <= 0 || isNaN(height) || height <= 0) {
                    errorMsg.textContent = "Please enter valid weight (kg) and height (m).";
                    errorMsg.classList.remove('hidden');
                    return;
                }
                
                weightKg = weight;
                heightM = height;
                
            } else { // Imperial System
                const weightLbs = parseFloat(document.getElementById('weight-lbs').value);
                const heightFt = parseFloat(document.getElementById('height-ft').value);
                const heightIn = parseFloat(document.getElementById('height-in').value);
                
                if (isNaN(weightLbs) || weightLbs <= 0 || (isNaN(heightFt) && isNaN(heightIn))) {
                    errorMsg.textContent = "Please enter valid weight (lbs) and height (ft/in).";
                    errorMsg.classList.remove('hidden');
                    return;
                }
                
                // Convert Imperial to Metric
                // 1 lb = 0.453592 kg
                // 1 inch = 0.0254 meters
                
                weightKg = weightLbs * 0.453592;
                
                // Total height in inches
                const totalInches = (heightFt || 0) * 12 + (heightIn || 0);
                heightM = totalInches * 0.0254;

                if (heightM <= 0) {
                    errorMsg.textContent = "Height cannot be zero.";
                    errorMsg.classList.remove('hidden');
                    return;
                }
            }

            // --- 2. Calculate BMI ---
            // Formula: weight (kg) / [height (m)]^2
            const bmi = weightKg / (heightM * heightM);

            // --- 3. Determine Category and Styling ---
            let category = '';
            let advice = '';
            let colorClass = '';

            if (bmi < 18.5) {
                category = 'Underweight';
                advice = 'Consider consulting a healthcare provider for healthy weight gain.';
                colorClass = 'text-blue-500 bg-blue-100'; // Blue for caution
            } else if (bmi >= 18.5 && bmi < 24.9) {
                category = 'Normal Weight';
                advice = 'Great job! Keep up the healthy lifestyle.';
                colorClass = 'text-green-600 bg-green-100'; // Green for good
            } else if (bmi >= 25 && bmi < 29.9) {
                category = 'Overweight';
                advice = 'Focus on diet and increasing physical activity.';
                colorClass = 'text-yellow-600 bg-yellow-100'; // Yellow for warning
            } else {
                category = 'Obesity';
                advice = 'It is recommended to speak with a healthcare professional.';
                colorClass = 'text-red-600 bg-red-100'; // Red for severe warning
            }

            // --- 4. Display Results ---
            const bmiDisplay = document.getElementById('bmi-display');
            const categoryDisplay = document.getElementById('category-display');
            const adviceDisplay = document.getElementById('advice-display');
            
            // Clear previous classes
            bmiDisplay.className = 'text-3xl font-extrabold text-center mb-2 transition duration-300';
            categoryDisplay.className = 'text-lg font-semibold text-center';
            resultBox.className = 'mt-8 p-4 rounded-lg shadow-inner transition duration-300 ' + colorClass;

            bmiDisplay.textContent = `${name}, your BMI is: ${bmi.toFixed(2)}`;
            categoryDisplay.textContent = `Category: ${category}`;
            adviceDisplay.textContent = advice;
        }

        // Set initial state to metric (redundant but good practice)
        window.onload = function() {
            toggleUnits('metric'); 
        };
    </script>
</body>
</html>
